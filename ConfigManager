if getgenv().ConfigManager then return getgenv().ConfigManager end

local HttpService = game:GetService("HttpService")
local ConfigManager = {}

local EXT = ".cfg"
local PREFIX = "VOIDXX_"

local function fileName(name)
	return PREFIX .. name .. EXT
end

function ConfigManager.save(name, data)
	if type(name) ~= "string" or name == "" then name = "VOID XX" end
	if type(data) ~= "table" then return false end
	local ok = pcall(function()
		writefile(fileName(name), HttpService:JSONEncode(data))
	end)
	return ok
end

function ConfigManager.load(name)
	if type(name) ~= "string" or name == "" then return nil end
	local ok, result = pcall(function()
		return HttpService:JSONDecode(readfile(fileName(name)))
	end)
	return ok and result or nil
end

function ConfigManager.delete(name)
	if type(name) ~= "string" or name == "" then return end
	pcall(function() delfile(fileName(name)) end)
end

function ConfigManager.list()
	local configs = {}
	local ok, files = pcall(listfiles, "")
	if not ok then return configs end
	for _, path in pairs(files) do
		local name = path:match("VOIDXX_(.+)%.cfg$")
		if name then
			table.insert(configs, name)
		end
	end
	return configs
end

function ConfigManager.exists(name)
	if type(name) ~= "string" or name == "" then return false end
	return isfile(fileName(name))
end

getgenv().ConfigManager = ConfigManager
return ConfigManager
